\NeedsTeXFormat{LaTeX2e}[2024/11/01]
\ProvidesPackage{tooling/luaboolean}[2025/10/07 v0.1.0 Lua Boolean]

\RequirePackage{luacode}
\begin{luacode*}
  CastLuaBoolToLaTeX = function(b)
	local LATEX_BOOL_TRUE = [[\noexpand\BooleanTrue]]
	local LATEX_BOOL_FALSE = [[\noexpand\BooleanFalse]]
	if b then
	  return LATEX_BOOL_TRUE
	end
	return LATEX_BOOL_FALSE
  end
\end{luacode*}

\ExplSyntaxOn
\NewDocumentCommand\LuaBool{m}{\directlua{tex.sprint(CastLuaBoolToLaTeX(#1))}}

\NewDocumentCommand\IfLuaBooleanTF{mmm}{
  \exp_args:Nf\IfBooleanTF{\LuaBool{#1}}{#2}{#3}
}
\NewDocumentCommand\IfLuaBooleanF{mm}{\IfLuaBooleanTF{#1}{}{#2}}
\NewDocumentCommand\IfLuaBooleanT{mm}{\IfLuaBooleanTF{#1}{#2}{}}

% \IfBooleanTF-like commands do not expand their argument.
% Let's define appropriate variants of them which do expansion
\NewDocumentCommand\IfBoolFlagT{mm}{
  \exp_args:Nf\IfBooleanT{#1}{#2}
}
\NewDocumentCommand\IfBoolFlagF{mm}{
  \exp_args:Nf\IfBooleanF{#1}{#2}
}
\NewDocumentCommand\IfBoolFlagTF{mmm}{
  \exp_args:Nf\IfBooleanTF{#1}{#2}{#3}
}
\ExplSyntaxOff
